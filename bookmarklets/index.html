<html>
  <head>
    <title>My Bookmarklets</title>
    <link rel="icon" type="image/png" href="icon.png">
    <script>
      function doNotClick() {
        alert('Drag this link into your bookmarks bar.');
        return false;
      }
    </script>
    <style>
      table {
        font-size: 14px;
        background: #fff;
        width: 100%;
        border-collapse: collapse;
        text-align: left;
        margin: 20px;
      }
      th {
        font-size: 14px;
        font-weight: 400;
        color: #039;
        border-bottom: 2px solid #6678b1;
        padding: 10px 8px;
      }
      body {
        font-family: sans-serif;
      }
      thead tbody {
        box-sizing: border-box;
      }
      tr {
        border-bottom: 1px solid #ddd;
      }
      a {
        text-decoration: none;
      }
      .nameColumn {
        width: 360px;
      }
      .versionColumn {
        width: 100px;
      }
      .grayLink {
        color: gray;
      }
      .row:nth-child(even) {
        background: #eeeeee;
      }
      .td {
        padding: 9px 8px 0;
      }
      .small {
        font-size: 9px;
        font-style: italic;
        margin: 20px;
      }
    </style>
  </head>
  <body>
    <h1 style="margin-bottom: 11px">My Bookmarklets</h1>

    <p>

    To use one of these, just drag its name into your bookmarks bar.

    <table>
      <tr>
        <th class="nameColumn">Name</th>
        <th class="versionColumn">Version</th>
        <th>Description</th>
      </tr>
      <tr>
        <td class="nameColumn">
          <a href="javascript:(async%20()%20=%3E%20%7B%20/*%20*%20Big%20Conditional%20Formatting%20*%20[v1.0]%20*%20*%20Enlarges%20the%20tiny%20conditional%20formatting%20custom%20formula%20input%20in%20Sheets.%20*/%20const%20style%20=%20(node)%20=%3E%20%7B%20return%20node.style;%20%7D;%20main%20=%20async%20()%20=%3E%20%7B%20const%20sidebar%20=%20[...document.querySelectorAll('div.waffle-sidebar-container')]%20.find(sidebar%20=%3E%20style(sidebar).display%20!==%20'none');%20if%20(!sidebar)%20%7B%20alert('Could%20not%20find%20displayed%20sidebar.');%20return;%20%7D%20const%20input%20=%20document.querySelector('input.waffle-conditionalformat-arg1');%20if%20(sidebar.getAttribute('_madebig')%20===%20'true')%20%7B%20style(sidebar).width%20=%20null;%20if%20(input)%20%7B%20style(input).width%20=%20null;%20%7D%20sidebar.removeAttribute('_madebig');%20%7D%20else%20%7B%20if%20(!input)%20%7B%20alert('Could%20not%20find%20conditional%20formatting%20input.');%20return;%20%7D%20style(sidebar).width%20=%20'1000px';%20style(input).width%20=%20'948px';%20sidebar.setAttribute('_madebig',%20'true');%20%7D%20%7D;%20await%20main();%20%7D)();" onclick="return doNotClick()">Big Conditional Formatting</a>
        </td>
        <td class="versionColumn">1.0</a>
        <td>
          
Enlarges the tiny conditional formatting custom formula input in Sheets.
        </td>
      </tr>
      <tr>
        <td class="nameColumn">
          <a href="javascript:(async%20()%20=%3E%20%7B%20/*%20*%20Expand%20All%20Nextdoor%20Comments%20*%20[v1.1]%20*%20*%20Adds%20a%20link%20to%20expand%20all%20comments%20for%20each%20Nextdoor%20post%20on%20the%20screen.%20*/%20const%20elem%20=%20(node)%20=%3E%20%7B%20return%20node;%20%7D;%20main%20=%20async%20()%20=%3E%20%7B%20document.querySelectorAll('div[data-testid=%22post-reply-button%22]').forEach(commentElement%20=%3E%20%7B%20const%20commentButton%20=%20commentElement;%20if%20(!commentButton.getAttribute('__handled'))%20%7B%20const%20link%20=%20document.createElement('A');%20link.innerText%20=%20'expand%20all';%20link.href%20=%20'javascript:void(0)';%20link.onclick%20=%20()%20=%3E%20%7B%20const%20postNodeChild%20=%20commentButton.closest('div.js-media-post');%20if%20(!postNodeChild)%20%7B%20alert('Could%20not%20find%20div.js-media-post');%20return;%20%7D%20const%20postNode%20=%20postNodeChild.parentNode;%20/*%20First%20click%20just%20shows%20%22add%20comment%22%20(sometimes%20needs%20two%20clicks).%20*/%20commentButton.click();%20window.setTimeout(()%20=%3E%20%7B%20commentButton.click();%20window.setTimeout(()%20=%3E%20%7B%20window.setTimeout(()%20=%3E%20%7B%20const%20callback%20=%20mutations%20=%3E%20%7B%20if%20(mutations.find(mutation%20=%3E%20mutation.type%20===%20'childList'))%20%7B%20console.log('[Expand%20all%20Nextdoor%20comments]%20Clicking%20expand-replies%20buttons');%20postNode%20.querySelectorAll('div.see-previous-comments-button-paged')%20.forEach(div%20=%3E%20%7B%20elem(div.querySelector('div[role=%22button%22]')).click();%20%7D);%20%7D%20%7D;%20const%20config%20=%20%7B%20attributes:%20false,%20childList:%20true,%20subtree:%20true%20%7D;%20new%20MutationObserver(callback).observe(postNode,%20config);%20link.parentNode.removeChild(link);%20%7D,%20100);%20%7D,%200);%20%7D,%200);%20%7D;%20const%20parent%20=%20commentButton.closest('div.post-action-container');%20parent.insertBefore(link,%20parent.firstChild);%20commentButton.setAttribute('__handled',%20'true');%20%7D%20%7D);%20%7D;%20await%20main();%20%7D)();" onclick="return doNotClick()">Expand All Nextdoor Comments</a>
        </td>
        <td class="versionColumn">1.1</a>
        <td>
          
Adds a link to expand all comments for each Nextdoor post on the screen.
        </td>
      </tr>
      <tr>
        <td class="nameColumn">
          <a href="javascript:(async%20()%20=%3E%20%7B%20/*%20*%20Keyword%20Solver%20*%20[v1.0]%20*%20*%20Invokes%20the%20Keyword%20solver%20(with%20hints)%20on%20the%20current%20Keyword.%20Just%20for%20fun%20-%20no%20cheating.%20*/%20const%20innerText%20=%20(node)%20=%3E%20%7B%20return%20node.innerText;%20%7D;%20main%20=%20async%20()%20=%3E%20%7B%20const%20grid%20=%20new%20Array(6);%20for%20(let%20i%20=%200;%20i%20%3C%206;%20i%2B%2B)%20%7B%20grid[i]%20=%20new%20Array(9);%20%7D%20const%20iframeDocument%20=%20document.querySelector('main').querySelector('iframe').contentWindow.document;%20Array.from(iframeDocument.querySelector('div.game-area').childNodes)%20.forEach((node,%20index)%20=%3E%20%7B%20const%20wordIndex%20=%20index%20%%206;%20const%20letterIndex%20=%20Math.floor(index%20/%206);%20const%20letter%20=%20innerText(node).match(/[0-9]$/)%20?%20'_'%20:%20innerText(node);%20grid[wordIndex][letterIndex]%20=%20letter;%20%7D);%20const%20words%20=%20grid.map(letters%20=%3E%20letters.join('')).join(',');%20window.open('https://feit.app/keyword/index.html?words='%20%2B%20words,%20'_blank');%20%7D;%20await%20main();%20%7D)();" onclick="return doNotClick()">Keyword Solver</a>
        </td>
        <td class="versionColumn">1.0</a>
        <td>
          
Invokes the Keyword solver (with hints) on the current Keyword. Just for fun - no cheating.
        </td>
      </tr>
      <tr>
        <td class="nameColumn">
          <a href="javascript:(async%20()%20=%3E%20%7B%20/*%20*%20Nextdoor%20Filter%20Recent%20Search%20*%20[v1.1]%20*%20*%20Filters%20Nextdoor's%20unordered%20%22Posts%22%20search%20results%20for%20ones%20which%20are%20recent.%20*/%20const%20createLogFunc%20=%20(prefix)%20=%3E%20%7B%20return%20(message,%20object)%20=%3E%20console.log(%60[$%7Bprefix%7D]%20$%7Bmessage%7D%60,%20object%20?%20object%20:%20'');%20%7D;%20const%20createErrorLogFunc%20=%20(prefix)%20=%3E%20%7B%20return%20(message,%20object)%20=%3E%20console.error(%60[$%7Bprefix%7D]%20$%7Bmessage%7D%60,%20object%20?%20object%20:%20'');%20%7D;%20const%20installObserver%20=%20(callback,%20logFunc,%20rootElement,%20attrName)%20=%3E%20%7B%20if%20(!attrName)%20%7B%20attrName%20=%20callback.name;%20%7D%20if%20(!attrName)%20%7B%20throw%20new%20Error('callback%20must%20be%20a%20named%20function,%20or%20attrName%20must%20be%20provided');%20%7D%20if%20(!window[attrName])%20%7B%20logFunc('Installing%20change%20observer...');%20window[attrName]%20=%20new%20MutationObserver(callback);%20resumeObserver(window[attrName],%20rootElement);%20%7D%20else%20%7B%20logFunc('Change%20observer%20already%20installed...');%20%7D%20return%20window[attrName];%20%7D;%20const%20pauseObserver%20=%20(observer)%20=%3E%20%7B%20observer.disconnect();%20%7D;%20const%20resumeObserver%20=%20(observer,%20rootElement)%20=%3E%20%7B%20const%20config%20=%20%7B%20attributes:%20false,%20childList:%20true,%20subtree:%20true%20%7D;%20observer.observe(rootElement%20?%20rootElement%20:%20document.body,%20config);%20%7D;%20main%20=%20async%20()%20=%3E%20%7B%20const%20log%20=%20createLogFunc('Nextdoor%20Filter%20Recent%20Search');%20if%20(window.location.href.indexOf('https://nextdoor.com/search/posts/')%20!==%200)%20%7B%20alert('Must%20be%20on%20https://nextdoor.com/search/posts/');%20return;%20%7D%20const%20doFilter%20=%20()%20=%3E%20%7B%20document.querySelectorAll('div[data-testid%5E=%22dwell-tracker-searchFeedItem:%22]').forEach(x%20=%3E%20%7B%20const%20div%20=%20x;%20if%20(!div.innerText.match(/%20(days%20ago%7Cday%20ago%7Cyesterday%7Ctoday)/))%20%7B%20div.parentElement.style.display%20=%20'none';%20%7D%20%7D);%20%7D;%20doFilter();%20installObserver(doFilter,%20log);%20%7D;%20await%20main();%20%7D)();" onclick="return doNotClick()">Nextdoor Filter Recent Search</a>
        </td>
        <td class="versionColumn">1.1</a>
        <td>
          
Filters Nextdoor's unordered "Posts" search results for ones which are recent.
        </td>
      </tr>
      <tr>
        <td class="nameColumn">
          <a href="javascript:(async%20()%20=%3E%20%7B%20/*%20*%20%F0%9F%87%BA%F0%9F%87%B8%20OATH%20To%20ActBlue%20*%20[v1.3]%20*%20*%20Adds%20links%20to%20ActBlue%20and%20Google%20for%20candidates%20on%20app.oath.vote%20pages.%20*/%20const%20innerText%20=%20(node)%20=%3E%20%7B%20return%20node.innerText;%20%7D;%20main%20=%20async%20()%20=%3E%20%7B%20document.querySelectorAll('div[class*=%22styled__CardContent-%22]').forEach(card%20=%3E%20%7B%20const%20row%20=%20card.querySelector('div[class*=%22Row-sc-%22]');%20const%20candidateName%20=%20innerText(row.querySelector('span[class*=%22styled__Title-%22]')%20??%20row.querySelector('span[class*=%22Typography__Body%22]')).trim();%20const%20where%20=%20innerText(row.querySelector('span[class*=%22styled__Subtitle-%22]')).trim();%20const%20createLink%20=%20(href,%20innerText)%20=%3E%20%7B%20const%20link%20=%20document.createElement('a');%20link.href%20=%20href;%20link.innerText%20=%20innerText;%20link.target%20=%20'_blank';%20link.style.display%20=%20'block';%20link.style.fontFamily%20=%20'sans-serif';%20return%20link;%20%7D;%20const%20textPieces%20=%20where%20.split('%20')%20.map(piece%20=%3E%20piece.replace(/%5E([0-9])$/,%20'0$1'))%20.join('&text=');%20const%20actBlueFragment%20=%20%60#:~:text=$%7BtextPieces%7D%60;%20const%20actBlueLink%20=%20createLink(%60https://secure.actblue.com/directory?query=$%7BencodeURIComponent(candidateName)%7D$%7BactBlueFragment%7D%60,%20'%E2%86%92ActBlue');%20const%20googleLink%20=%20createLink('https://www.google.com/search?q='%20%2B%20encodeURIComponent(%60%22$%7BcandidateName%7D%22%20$%7Bwhere%7D%60),%20'%E2%86%92Google');%20const%20addedContent%20=%20document.createElement('div');%20addedContent.appendChild(actBlueLink);%20addedContent.appendChild(googleLink);%20card.appendChild(addedContent);%20console.log('[OATH%20to%20ActBlue]',%20%60Added%20links%20for%20candidate%20$%7BcandidateName%7D%60);%20/*%20Hide%20the%20Donate%20button.%20*/%20document.querySelectorAll('button').forEach(button%20=%3E%20button.style.display%20=%20'none');%20%7D);%20%7D;%20await%20main();%20%7D)();" onclick="return doNotClick()">🇺🇸 OATH To ActBlue </a>
        </td>
        <td class="versionColumn">1.3</a>
        <td>
          
Adds links to ActBlue and Google for candidates on app.oath.vote pages.
        </td>
      </tr>
      <tr>
        <td class="nameColumn">
          <a href="javascript:(async%20()%20=%3E%20%7B%20/*%20*%20Open%20Threads%20Link%20*%20[v1.1]%20*%20*%20Opens%20the%20link%20on%20a%20Threads%20post%20page,%20then%20closes%20the%20current%20window.%20*/%20main%20=%20async%20()%20=%3E%20%7B%20let%20url;%20if%20(window.location.href.match(/%5Ehttps://www.threads.net/[%5E/]%2B/post//))%20%7B%20url%20=%20document.querySelector('a[target=%22_blank%22]').href;%20%7D%20else%20%7B%20alert('Must%20be%20on%20a%20Threads%20post%20page.');%20return;%20%7D%20if%20(!url)%20%7B%20alert('Could%20not%20find%20URL');%20return;%20%7D%20window.open(url);%20setTimeout(()%20=%3E%20window.close(),%200);%20%7D;%20await%20main();%20%7D)();" onclick="return doNotClick()">Open Threads Link </a>
        </td>
        <td class="versionColumn">1.1</a>
        <td>
          
Opens the link on a Threads post page, then closes the current window.
        </td>
      </tr>
      <tr>
        <td class="nameColumn">
          <a href="javascript:(async%20()%20=%3E%20%7B%20/*%20*%20%F0%9F%97%9C%20Small%20Gmail%20Labels%20*%20[v1.2]%20*%20*%20Reduces%20the%20size%20of%20labels%20and%20other%20things%20in%20the%20Gmail%20nav%20pane.%20*/%20const%20createLogFunc%20=%20(prefix)%20=%3E%20%7B%20return%20(message,%20object)%20=%3E%20console.log(%60[$%7Bprefix%7D]%20$%7Bmessage%7D%60,%20object%20?%20object%20:%20'');%20%7D;%20const%20createErrorLogFunc%20=%20(prefix)%20=%3E%20%7B%20return%20(message,%20object)%20=%3E%20console.error(%60[$%7Bprefix%7D]%20$%7Bmessage%7D%60,%20object%20?%20object%20:%20'');%20%7D;%20const%20innerText%20=%20(node)%20=%3E%20%7B%20return%20node.innerText;%20%7D;%20const%20style%20=%20(node)%20=%3E%20%7B%20return%20node.style;%20%7D;%20const%20installObserver%20=%20(callback,%20logFunc,%20rootElement,%20attrName)%20=%3E%20%7B%20if%20(!attrName)%20%7B%20attrName%20=%20callback.name;%20%7D%20if%20(!attrName)%20%7B%20throw%20new%20Error('callback%20must%20be%20a%20named%20function,%20or%20attrName%20must%20be%20provided');%20%7D%20if%20(!window[attrName])%20%7B%20logFunc('Installing%20change%20observer...');%20window[attrName]%20=%20new%20MutationObserver(callback);%20resumeObserver(window[attrName],%20rootElement);%20%7D%20else%20%7B%20logFunc('Change%20observer%20already%20installed...');%20%7D%20return%20window[attrName];%20%7D;%20const%20pauseObserver%20=%20(observer)%20=%3E%20%7B%20observer.disconnect();%20%7D;%20const%20resumeObserver%20=%20(observer,%20rootElement)%20=%3E%20%7B%20const%20config%20=%20%7B%20attributes:%20false,%20childList:%20true,%20subtree:%20true%20%7D;%20observer.observe(rootElement%20?%20rootElement%20:%20document.body,%20config);%20%7D;%20main%20=%20async%20()%20=%3E%20%7B%20const%20log%20=%20createLogFunc('Small%20Gmail%20Labels');%20const%20refresh%20=%20()%20=%3E%20%7B%20log('running...');%20const%20nav%20=%20document.querySelector('div[role=%22navigation%22]');%20const%20labels%20=%20Array.from(nav.querySelectorAll('a[href*=%22#label%22]'))%20.concat(Array.from(nav.querySelectorAll('a[href*=%22#inbox%22]')))%20.concat(Array.from(nav.querySelectorAll('a[href*=%22#drafts%22]')))%20.concat(Array.from(nav.querySelectorAll('a[href*=%22#scheduled%22]')))%20.concat(Array.from(nav.querySelectorAll('a[href*=%22#sent%22]')));%20labels.forEach(labelLink%20=%3E%20%7B%20let%20container;%20for%20(let%20parent%20=%20labelLink.parentElement;%20parent;%20parent%20=%20parent.parentElement)%20%7B%20if%20(parent.getAttribute('data-tooltip'))%20%7B%20container%20=%20parent;%20break;%20%7D%20%7D%20style(labelLink).fontSize%20=%20'12px';%20style(container).height%20=%20'25px';%20%7D);%20nav.querySelectorAll('span[role=%22button%22]').forEach(button%20=%3E%20%7B%20if%20(button.firstChild%20&&%20innerText(button.firstChild)%20===%20'More')%20%7B%20style(button.firstChild).fontSize%20=%20'12px';%20%7D%20%7D);%20nav.querySelectorAll('div[role=%22button%22]').forEach(div%20=%3E%20%7B%20if%20(innerText(div)%20===%20'Compose')%20%7B%20style(div).height%20=%20'25px';%20style(div.parentElement).height%20=%20'50px';%20style(div.parentElement.parentElement).height%20=%20'60px';%20%7D%20%7D);%20nav.querySelectorAll('span[role=%22heading%22]').forEach(span%20=%3E%20%7B%20if%20(innerText(span)%20===%20'Labels')%20%7B%20style(span).fontSize%20=%20'12px';%20style(span.parentElement).height%20=%20'0px';%20%7D%20%7D);%20style(nav.querySelector('div[aria-label=%22Create%20new%20label%22]')).height%20=%20'10px';%20%7D;%20refresh();%20installObserver(refresh,%20log);%20%7D;%20await%20main();%20%7D)();" onclick="return doNotClick()">🗜 Small Gmail Labels</a>
        </td>
        <td class="versionColumn">1.2</a>
        <td>
          
Reduces the size of labels and other things in the Gmail nav pane.
        </td>
      </tr>
      <tr>
        <td class="nameColumn">
          <a href="javascript:(async%20()%20=%3E%20%7B%20/*%20*%20Turn%20On%20Design%20Mode%20*%20[v1.0]%20*%20*%20Makes%20the%20current%20web%20page%20editable!%20*/%20main%20=%20async%20()%20=%3E%20%7B%20document.designMode%20=%20'on';%20%7D;%20await%20main();%20%7D)();" onclick="return doNotClick()">Turn On Design Mode</a>
        </td>
        <td class="versionColumn">1.0</a>
        <td>
          
Makes the current web page editable!
        </td>
      </tr>
      <tr>
        <td class="nameColumn">
          <a href="javascript:(async%20()%20=%3E%20%7B%20/*%20*%20%E2%86%91%20Move%20Apps%20Script%20File%20Up%20*%20[v1.0]%20*%20*%20Moves%20the%20currently-selected%20file%20in%20the%20Apps%20Script%20editor%20up.%20*/%20const%20createLogFunc%20=%20(prefix)%20=%3E%20%7B%20return%20(message,%20object)%20=%3E%20console.log(%60[$%7Bprefix%7D]%20$%7Bmessage%7D%60,%20object%20?%20object%20:%20'');%20%7D;%20const%20createErrorLogFunc%20=%20(prefix)%20=%3E%20%7B%20return%20(message,%20object)%20=%3E%20console.error(%60[$%7Bprefix%7D]%20$%7Bmessage%7D%60,%20object%20?%20object%20:%20'');%20%7D;%20/**%20*%20Waits%20for%20an%20element%20to%20appear,%20then%20invokes%20a%20provided%20function%20on%20it.%20*%20*%20%20elemFuncOrQuerySelector%20-%20Either%20a%20query%20selector%20(string)%20to%20find%20the%20element,%20or%20a%20*%20function%20that%20returns%20it.%20*%20%20elemDescription%20-%20A%20text%20description%20of%20the%20element,%20for%20logging.%20*%20%20logFunc%20-%20The%20function%20to%20emit%20logging%20messages%20(the%20message%20is%20the%20single%20parameter).%20*%20%20whenFoundFunc%20-%20The%20function%20to%20invoke%20when%20the%20element%20is%20found%20(element%20is%20the%20single%20*%20parameter%20of%20it.%20*%20%20triesLeft%20-%20The%20number%20of%20retries;%20defaults%20to%2020.%20*%20%20tryIntervalMillis%20-%20The%20number%20of%20milliseconds%20between%20retries;%20defaults%20to%20100.%20*/%20const%20waitForSync%20=%20(elemFuncOrQuerySelector,%20elemDescription,%20logFunc,%20whenFoundFunc,%20triesLeft,%20tryIntervalMillis,%20failFunc)%20=%3E%20%7B%20const%20elem%20=%20typeof%20elemFuncOrQuerySelector%20===%20'string'%20?%20document.querySelector(elemFuncOrQuerySelector)%20:%20elemFuncOrQuerySelector();%20if%20(!elem)%20%7B%20if%20(triesLeft%20%7C%7C%20triesLeft%20===%20undefined)%20%7B%20logFunc(%60Waiting%20for%20$%7BelemDescription%7D...%60);%20const%20nextTriesLeft%20=%20triesLeft%20===%20undefined%20?%2050%20:%20triesLeft%20-%201;%20setTimeout(()%20=%3E%20waitForSync(elemFuncOrQuerySelector,%20elemDescription,%20logFunc,%20whenFoundFunc,%20nextTriesLeft,%20tryIntervalMillis,%20failFunc),%20tryIntervalMillis%20?%20tryIntervalMillis%20:%20100);%20%7D%20else%20%7B%20(failFunc%20?%20failFunc%20:%20alert)(%60Could%20not%20find%20$%7BelemDescription%7D%60);%20%7D%20return;%20%7D%20logFunc(%60Found%20$%7BelemDescription%7D.%60);%20whenFoundFunc(elem);%20%7D;%20const%20waitFor%20=%20(elemFuncOrQuerySelector,%20elemDescription,%20logFunc,%20triesLeft,%20tryIntervalMillis)%20=%3E%20%7B%20return%20new%20Promise((resolve,%20reject)%20=%3E%20waitForSync(elemFuncOrQuerySelector,%20elemDescription,%20logFunc,%20resolve,%20triesLeft,%20tryIntervalMillis,%20reject));%20%7D;%20const%20waitMillis%20=%20(millis,%20element)%20=%3E%20%7B%20return%20new%20Promise((resolve,%20reject)%20=%3E%20setTimeout(()%20=%3E%20resolve(element),%20millis));%20%7D;%20const%20clickMenuItem%20=%20(menuItem,%20window)%20=%3E%20%7B%20const%20options%20=%20%7B%20bubbles:%20true,%20cancelable:%20true,%20view:%20window%20%7D;%20menuItem.dispatchEvent(new%20MouseEvent('mousedown',%20options));%20menuItem.dispatchEvent(new%20MouseEvent('mouseup',%20options));%20return%20menuItem;%20%7D;%20main%20=%20async%20()%20=%3E%20%7B%20const%20log%20=%20createLogFunc('Move%20Apps%20Script%20File%20Up%20');%20const%20list%20=%20document.querySelector('ul[aria-label=%22Project%20files%22]');%20if%20(!list)%20%7B%20return%20alert('Could%20not%20find%20project%20files%20list');%20%7D%20let%20selectedItem%20=%20list.querySelector('li[aria-selected=%22true%22]');%20if%20(!selectedItem)%20%7B%20const%20fileName%20=%20list.getAttribute('masf_selected_file');%20if%20(fileName)%20%7B%20selectedItem%20=%20list.querySelector(%60li[aria-label=%22$%7BfileName%7D%22]%60);%20%7D%20%7D%20if%20(!selectedItem)%20%7B%20return%20alert('Could%20not%20find%20selected%20item%20in%20project%20files%20list');%20%7D%20/*%20Once%20we%20move%20it%20up,%20it's%20no%20longer%20selected.%20*/%20const%20fileName%20=%20selectedItem.getAttribute('aria-label');%20if%20(!fileName)%20%7B%20return%20alert('Could%20not%20find%20file%20name');%20%7D%20list.setAttribute('masf_selected_file',%20fileName);%20const%20button%20=%20selectedItem.querySelector('div[role=%22button%22][aria-label%5E=%22File%20operations%20menu%22]');%20if%20(!button)%20%7B%20return%20alert('Could%20not%20find%20file%20operations%20menu%20button');%20%7D%20button.click();%20const%20menuItem%20=%20await%20waitFor('span[role=%22menuitem%22][aria-label=%22Move%20file%20up%22]',%20'move-file-up%20item',%20log);%20if%20(!menuItem)%20%7B%20return%20alert('Could%20not%20find%20move-file-up%20menu%20item');%20%7D%20/*%20For%20some%20reason%20we%20have%20to%20wait%20half%20a%20second%20before%20clicking%20the%20menu%20item.%20*/%20await%20waitMillis(500);%20clickMenuItem(menuItem,%20window);%20%7D;%20await%20main();%20%7D)();" onclick="return doNotClick()">↑ Move Apps Script File Up </a>
        </td>
        <td class="versionColumn">1.0</a>
        <td>
          
Moves the currently-selected file in the Apps Script editor up.
        </td>
      </tr>
      <tr>
        <td class="nameColumn">
          <a href="javascript:(async%20()%20=%3E%20%7B%20/*%20*%20Apps%20Script%20Archive%20Deployment%20*%20[v2.3]%20*%20*%20Clicks%20all%20the%20buttons%20to%20archive%20a%20deployment%20in%20Apps%20Script.%20*/%20const%20createLogFunc%20=%20(prefix)%20=%3E%20%7B%20return%20(message,%20object)%20=%3E%20console.log(%60[$%7Bprefix%7D]%20$%7Bmessage%7D%60,%20object%20?%20object%20:%20'');%20%7D;%20const%20createErrorLogFunc%20=%20(prefix)%20=%3E%20%7B%20return%20(message,%20object)%20=%3E%20console.error(%60[$%7Bprefix%7D]%20$%7Bmessage%7D%60,%20object%20?%20object%20:%20'');%20%7D;%20/**%20*%20Waits%20for%20an%20element%20to%20appear,%20then%20invokes%20a%20provided%20function%20on%20it.%20*%20*%20%20elemFuncOrQuerySelector%20-%20Either%20a%20query%20selector%20(string)%20to%20find%20the%20element,%20or%20a%20*%20function%20that%20returns%20it.%20*%20%20elemDescription%20-%20A%20text%20description%20of%20the%20element,%20for%20logging.%20*%20%20logFunc%20-%20The%20function%20to%20emit%20logging%20messages%20(the%20message%20is%20the%20single%20parameter).%20*%20%20whenFoundFunc%20-%20The%20function%20to%20invoke%20when%20the%20element%20is%20found%20(element%20is%20the%20single%20*%20parameter%20of%20it.%20*%20%20triesLeft%20-%20The%20number%20of%20retries;%20defaults%20to%2020.%20*%20%20tryIntervalMillis%20-%20The%20number%20of%20milliseconds%20between%20retries;%20defaults%20to%20100.%20*/%20const%20waitForSync%20=%20(elemFuncOrQuerySelector,%20elemDescription,%20logFunc,%20whenFoundFunc,%20triesLeft,%20tryIntervalMillis,%20failFunc)%20=%3E%20%7B%20const%20elem%20=%20typeof%20elemFuncOrQuerySelector%20===%20'string'%20?%20document.querySelector(elemFuncOrQuerySelector)%20:%20elemFuncOrQuerySelector();%20if%20(!elem)%20%7B%20if%20(triesLeft%20%7C%7C%20triesLeft%20===%20undefined)%20%7B%20logFunc(%60Waiting%20for%20$%7BelemDescription%7D...%60);%20const%20nextTriesLeft%20=%20triesLeft%20===%20undefined%20?%2050%20:%20triesLeft%20-%201;%20setTimeout(()%20=%3E%20waitForSync(elemFuncOrQuerySelector,%20elemDescription,%20logFunc,%20whenFoundFunc,%20nextTriesLeft,%20tryIntervalMillis,%20failFunc),%20tryIntervalMillis%20?%20tryIntervalMillis%20:%20100);%20%7D%20else%20%7B%20(failFunc%20?%20failFunc%20:%20alert)(%60Could%20not%20find%20$%7BelemDescription%7D%60);%20%7D%20return;%20%7D%20logFunc(%60Found%20$%7BelemDescription%7D.%60);%20whenFoundFunc(elem);%20%7D;%20const%20waitFor%20=%20(elemFuncOrQuerySelector,%20elemDescription,%20logFunc,%20triesLeft,%20tryIntervalMillis)%20=%3E%20%7B%20return%20new%20Promise((resolve,%20reject)%20=%3E%20waitForSync(elemFuncOrQuerySelector,%20elemDescription,%20logFunc,%20resolve,%20triesLeft,%20tryIntervalMillis,%20reject));%20%7D;%20const%20waitMillis%20=%20(millis,%20element)%20=%3E%20%7B%20return%20new%20Promise((resolve,%20reject)%20=%3E%20setTimeout(()%20=%3E%20resolve(element),%20millis));%20%7D;%20const%20clickMenuItem%20=%20(menuItem,%20window)%20=%3E%20%7B%20const%20options%20=%20%7B%20bubbles:%20true,%20cancelable:%20true,%20view:%20window%20%7D;%20menuItem.dispatchEvent(new%20MouseEvent('mousedown',%20options));%20menuItem.dispatchEvent(new%20MouseEvent('mouseup',%20options));%20return%20menuItem;%20%7D;%20main%20=%20async%20()%20=%3E%20%7B%20const%20log%20=%20createLogFunc('Apps%20Script%20Archive%20Deployment');%20const%20findElementWithText%20=%20(querySelector,%20text)%20=%3E%20%7B%20return%20[...document.querySelectorAll(querySelector)]%20/*%20The%20replace%20removes%20any%20non-printable%20character%20from%20the%20end.%20*/%20.find(elem%20=%3E%20elem.innerText.trim().replace(/[%5E%20-~]*$/,%20'').startsWith(text)%20&&%20!elem.disabled);%20%7D;%20const%20findButtonWithText%20=%20(text)%20=%3E%20%7B%20return%20findElementWithText('div[role=%22button%22]',%20text)%20??%20findElementWithText('button',%20text);%20%7D;%20const%20DAY_MILLIS%20=%2024%20*%2060%20*%2060%20*%201000;%20const%20archiveOldest%20=%20async%20()%20=%3E%20%7B%20const%20button%20=%20await%20waitFor(()%20=%3E%20findButtonWithText('Deploy'),%20'Deploy%20button',%20log);%20button.click();%20const%20menuItem%20=%20await%20waitFor('span[role=%22menuitem%22][aria-label=%22Manage%20deployments%20option%22]',%20'Manage%20deployments%20menu%20item',%20log);%20/*%20For%20some%20reason%20we%20have%20to%20wait%20half%20a%20second%20before%20clicking%20the%20menu%20item.%20*/%20await%20waitMillis(500);%20clickMenuItem(menuItem,%20window);%20const%20list%20=%20await%20waitFor('ul[aria-label=%22Active%20deployment%20list%22]',%20'Active%20deployments%20list',%20log);%20const%20activeDeployments%20=%20[...list.querySelectorAll('li')];%20if%20(!activeDeployments.length)%20%7B%20return%20alert('Could%20not%20find%20any%20active%20deployments%20in%20the%20list.');%20%7D%20if%20(activeDeployments.length%20%3C%202)%20%7B%20return%20alert('Only%20one%20active%20deployment%20found.');%20%7D%20const%20lastDeployment%20=%20activeDeployments[activeDeployments.length%20-%201];%20const%20deploymentName%20=%20lastDeployment.innerText;%20lastDeployment.click();%20/*%20The%20%60*=%60%20is%20because%20there%20may%20be%20a%20space%20in%20the%20front%20of%20the%20deployment%20name.%20*/%20return%20waitForSync(%60input[value*=%22$%7BdeploymentName%7D%22]%60,%20'Deployment%20info',%20log,%20async%20(deploymentNameBox)%20=%3E%20%7B%20const%20dialog%20=%20deploymentNameBox.closest('div[role=%22dialog%22]');%20/*%20Make%20sure%20the%20version%20to%20be%20archived%20is%20at%20least%20a%20day%20old.%20*/%20const%20match%20=%20[...dialog.querySelectorAll('span')]%20.map(span%20=%3E%20span.innerText.trim().match(/Version%20([0-9]%2B)%20on%20(.*)/))%20.find(match%20=%3E%20match);%20if%20(!match)%20%7B%20return%20alert('Could%20not%20find%20%22Version%20###%20on%20...%22');%20%7D%20const%20versionDate%20=%20new%20Date(match[2]);%20if%20((new%20Date().getTime()%20-%20versionDate.getTime())%20%3C%20DAY_MILLIS)%20%7B%20const%20response%20=%20confirm(%60Version%20$%7Bmatch[1]%7D%20from%20%60%20%2B%20%60$%7BversionDate.toLocaleDateString()%7D%20(%22$%7BdeploymentName%7D%22)%20%60%20%2B%20'looks%20too%20new;%20continue?');%20if%20(!response)%20%7B%20return;%20%7D%20%7D%20const%20archiveDeploymentButton%20=%20document.querySelector('button[aria-label=%22Archive%20deployment%22]');%20archiveDeploymentButton.click();%20const%20archiveButton%20=%20await%20waitFor(()%20=%3E%20findButtonWithText('Archive'),%20'Archive%20button',%20log);%20archiveButton.click();%20const%20doneButton%20=%20await%20waitFor(()%20=%3E%20%7B%20return%20findElementWithText('div',%20'Deployment%20successfully%20archived')%20?%20findButtonWithText('Done')%20:%20null;%20%7D,%20'Done%20button',%20log);%20doneButton.click();%20const%20message%20=%20%60Archived%20deployment%20#$%7BactiveDeployments.length%7D%20(%22$%7BdeploymentName%7D%22).%60;%20if%20(activeDeployments.length%20%3E%202)%20%7B%20await%20waitMillis(0);%20const%20response%20=%20confirm(message%20%2B%20'%20Archive%20the%20next%20one?');%20if%20(response)%20%7B%20await%20archiveOldest();%20%7D%20%7D%20else%20%7B%20alert(message);%20%7D%20%7D);%20%7D;%20await%20archiveOldest();%20%7D;%20await%20main();%20%7D)();" onclick="return doNotClick()">Apps Script Archive Deployment </a>
        </td>
        <td class="versionColumn">2.3</a>
        <td>
          
Clicks all the buttons to archive a deployment in Apps Script.
        </td>
      </tr>
    </table>
  </body>
</html>
