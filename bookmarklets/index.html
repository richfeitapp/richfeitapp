<html>
  <head>
    <title>My Bookmarklets</title>
    <link rel="icon" type="image/png" href="icon.png">
    <script>
      function doNotClick() {
        alert('Drag this link into your bookmarks bar.');
        return false;
      }
    </script>
    <style>
      table {
        font-size: 14px;
        background: #fff;
        width: 100%;
        border-collapse: collapse;
        text-align: left;
        margin: 20px;
      }
      th {
        font-size: 14px;
        font-weight: 400;
        color: #039;
        border-bottom: 2px solid #6678b1;
        padding: 10px 8px;
      }
      body {
        font-family: sans-serif;
      }
      thead tbody {
        box-sizing: border-box;
      }
      tr {
        border-bottom: 1px solid #ddd;
      }
      a {
        text-decoration: none;
      }
      .nameColumn {
        width: 360px;
      }
      .versionColumn {
        width: 100px;
      }
      .grayLink {
        color: gray;
      }
      .row:nth-child(even) {
        background: #eeeeee;
      }
      .td {
        padding: 9px 8px 0;
      }
      .small {
        font-size: 9px;
        font-style: italic;
        margin: 20px;
      }
    </style>
  </head>
  <body>
    <h1 style="margin-bottom: 11px">My Bookmarklets</h1>

    <p>

    To use one of these, just drag its name into your bookmarks bar.

    <table>
      <tr>
        <th class="nameColumn">Name</th>
        <th class="versionColumn">Version</th>
        <th>Description</th>
      </tr>
      <tr>
        <td class="nameColumn">
          <a href="javascript:(async%20()%20=%3E%20%7B%20/*%20*%20Big%20Conditional%20Formatting%20*%20[v1.0]%20*%20*%20Enlarges%20the%20tiny%20conditional%20formatting%20custom%20formula%20input%20in%20Sheets.%20*/%20function%20elem(nodeOrId)%20%7B%20return%20(typeof%20nodeOrId%20===%20'string'%20?%20document.getElementById(nodeOrId)%20:%20nodeOrId);%20%7D%20function%20assertElement(nodeOrQuerySelector,%20description)%20%7B%20const%20isQuerySelector%20=%20typeof%20nodeOrQuerySelector%20===%20'string';%20const%20element%20=%20isQuerySelector%20?%20document.querySelector(nodeOrQuerySelector)%20:%20nodeOrQuerySelector;%20if%20(!element)%20%7B%20const%20descrip%20=%20description%20??%20'element'%20%2B%20(isQuerySelector%20?%20%60%20matching%20%22$%7BnodeOrQuerySelector%7D%22%60%20:%20'');%20throw%20new%20Error('Could%20not%20find%20'%20%2B%20descrip);%20%7D%20return%20element;%20%7D%20function%20querySelectorAll(selector,%20root,%20filter)%20%7B%20const%20results%20=%20[...(root%20??%20document).querySelectorAll(selector)]%20.map(elem%20=%3E%20elem);%20return%20filter%20?%20results.filter(filter)%20:%20results;%20%7D%20function%20querySelector(selector,%20root,%20filter)%20%7B%20const%20results%20=%20querySelectorAll(selector,%20root,%20filter);%20return%20results.length%20?%20results[0]%20:%20null;%20%7D%20function%20style(nodeOrId)%20%7B%20return%20elem(nodeOrId).style;%20%7D%20function%20hide(nodeOrId)%20%7B%20style(nodeOrId).display%20=%20'none';%20%7D%20function%20main()%20%7B%20const%20sidebar%20=%20[%20...document.querySelectorAll('div.waffle-sidebar-container'),%20].find((sidebar)%20=%3E%20style(sidebar).display%20!==%20'none');%20if%20(!sidebar)%20%7B%20alert('Could%20not%20find%20displayed%20sidebar.');%20return;%20%7D%20const%20input%20=%20document.querySelector('input.waffle-conditionalformat-arg1');%20if%20(sidebar.getAttribute('_madebig')%20===%20'true')%20%7B%20style(sidebar).width%20=%20'';%20if%20(input)%20%7B%20style(input).width%20=%20'';%20%7D%20sidebar.removeAttribute('_madebig');%20%7D%20else%20%7B%20if%20(!input)%20%7B%20alert('Could%20not%20find%20conditional%20formatting%20input.');%20return;%20%7D%20style(sidebar).width%20=%20'1000px';%20style(input).width%20=%20'948px';%20sidebar.setAttribute('_madebig',%20'true');%20%7D%20%7D%20main();%20%7D)();" onclick="return doNotClick()">Big Conditional Formatting</a>
        </td>
        <td class="versionColumn">1.0</a>
        <td>
          
Enlarges the tiny conditional formatting custom formula input in Sheets.
        </td>
      </tr>
      <tr>
        <td class="nameColumn">
          <a href="javascript:(async%20()%20=%3E%20%7B%20/*%20*%20Expand%20All%20Nextdoor%20Comments%20*%20[v1.2]%20*%20*%20Expands%20all%20comments%20on%20a%20Nextdoor%20post%20(on%20the%20post%20detail%20page%20-%20click%20the%20time%20of%20the%20post,%20then%20click%20again%20in%20the%20popup%20post%20dialog).%20*/%20function%20assert(condition,%20message,%20messageSuffix)%20%7B%20if%20(!condition)%20%7B%20if%20(typeof%20message%20===%20'function')%20%7B%20throw%20new%20Error(message());%20%7D%20const%20text%20=%20message%20?%20message%20%2B%20(messageSuffix%20?%20messageSuffix%20:%20'')%20:%20'assertion%20failed';%20throw%20new%20Error(text);%20%7D%20%7D%20function%20assertHasValue(value,%20message,%20messageSuffix)%20%7B%20assert(value,%20message,%20messageSuffix);%20return%20value;%20%7D%20function%20assertEquals(value,%20expected,%20message,%20messageSuffix)%20%7B%20const%20m%20=%20message%20?%20message%20:%20()%20=%3E%20%60Expected%20$%7Bexpected%7D,%20got%20$%7Bvalue%7D%60;%20assert(value%20===%20expected,%20message,%20messageSuffix);%20%7D%20function%20assertHasProperty(object,%20propertyName,%20message,%20disallowNullOrEmptyString)%20%7B%20if%20(object[propertyName]%20===%20undefined)%20%7B%20throw%20new%20Error(message%20?%20message%20:%20%60missing%20property%20%22$%7BpropertyName%7D%22%20in%20object:%20$%7BJSON.stringify(object)%7D%60);%20%7D%20if%20(disallowNullOrEmptyString%20&&%20!object[propertyName])%20%7B%20throw%20new%20Error(message%20?%20message%20:%20%60null/empty%20property%20%22$%7BpropertyName%7D%22%20in%20object:%20$%7BJSON.stringify(object)%7D%60);%20%7D%20return%20object[propertyName];%20%7D%20function%20assertMapValue(map,%20key,%20message,%20disallowNullOrEmptyString)%20%7B%20const%20result%20=%20map.get(key);%20if%20(result%20===%20undefined)%20%7B%20throw%20new%20Error(message%20?%20message%20:%20%60missing%20key%20%22$%7Bkey%7D%22%20in%20map:%20$%7B[...map.entries()]%7D%60);%20%7D%20if%20(disallowNullOrEmptyString%20&&%20!result)%20%7B%20throw%20new%20Error(message%20?%20message%20:%20%60null/empty%20value%20for%20%22$%7Bkey%7D%22%20in%20map:%20$%7B[...map.entries()]%7D%60);%20%7D%20return%20result;%20%7D%20function%20assertCurrentUrl(urlOrPattern)%20%7B%20const%20url%20=%20window.location.href;%20if%20(typeof%20urlOrPattern%20===%20'string')%20%7B%20if%20(url%20!==%20urlOrPattern)%20%7B%20window.alert('Must%20be%20on%20'%20%2B%20urlOrPattern);%20throw%20new%20Error('Must%20be%20on%20'%20%2B%20urlOrPattern);%20%7D%20%7D%20else%20%7B%20if%20(!urlOrPattern.test(url))%20%7B%20window.alert('Url%20must%20match%20'%20%2B%20urlOrPattern);%20throw%20new%20Error('Url%20must%20match%20'%20%2B%20urlOrPattern);%20%7D%20%7D%20%7D%20function%20assertCurrentUrlStartsWith(urlPrefix)%20%7B%20assertCurrentUrl(new%20RegExp('%5E'%20%2B%20urlPrefix));%20%7D%20class%20Logger%20%7B%20constructor(logPrefix)%20%7B%20this._logPrefix%20=%20logPrefix;%20%7D%20log(message,%20object)%20%7B%20console.log(%60[$%7Bthis._logPrefix%7D]%20$%7Bmessage%7D%60,%20object%20?%20object%20:%20'');%20%7D%20error(message,%20object)%20%7B%20console.error(%60[$%7Bthis._logPrefix%7D]%20$%7Bmessage%7D%60,%20object%20?%20object%20:%20'');%20%7D%20getLogPrefix()%20%7B%20return%20this._logPrefix;%20%7D%20_logPrefix;%20%7D%20assertCurrentUrl(/nextdoor.com/p/.*view=detail/);%20const%20logger%20=%20new%20Logger('Expand%20All%20Nextdoor%20Comments');%20function%20clickButton()%20%7B%20logger.log('Running...');%20const%20button%20=%20document.querySelector('[data-testid=%22seeMoreButton%22][role=%22button%22]');%20if%20(button)%20%7B%20logger.log('Clicking%20button');%20button.click();%20setTimeout(clickButton,%20500);%20%7D%20else%20%7B%20setTimeout(clickButton,%205000);%20%7D%20%7D%20clickButton();%20%7D)();" onclick="return doNotClick()">Expand All Nextdoor Comments</a>
        </td>
        <td class="versionColumn">1.2</a>
        <td>
          
Expands all comments on a Nextdoor post (on the post detail page - click the time of the post, then click again in the popup post dialog).
        </td>
      </tr>
      <tr>
        <td class="nameColumn">
          <a href="javascript:(async%20()%20=%3E%20%7B%20/*%20*%20Keyword%20Solver%20*%20[v1.0]%20*%20*%20Invokes%20the%20Keyword%20solver%20(with%20hints)%20on%20the%20current%20Keyword.%20Just%20for%20fun%20-%20no%20cheating.%20*/%20function%20innerText(node)%20%7B%20return%20node.innerText;%20%7D%20function%20elem(nodeOrId)%20%7B%20return%20(typeof%20nodeOrId%20===%20'string'%20?%20document.getElementById(nodeOrId)%20:%20nodeOrId);%20%7D%20function%20assertElement(nodeOrQuerySelector,%20description)%20%7B%20const%20isQuerySelector%20=%20typeof%20nodeOrQuerySelector%20===%20'string';%20const%20element%20=%20isQuerySelector%20?%20document.querySelector(nodeOrQuerySelector)%20:%20nodeOrQuerySelector;%20if%20(!element)%20%7B%20const%20descrip%20=%20description%20??%20'element'%20%2B%20(isQuerySelector%20?%20%60%20matching%20%22$%7BnodeOrQuerySelector%7D%22%60%20:%20'');%20throw%20new%20Error('Could%20not%20find%20'%20%2B%20descrip);%20%7D%20return%20element;%20%7D%20function%20querySelectorAll(selector,%20root,%20filter)%20%7B%20const%20results%20=%20[...(root%20??%20document).querySelectorAll(selector)]%20.map(elem%20=%3E%20elem);%20return%20filter%20?%20results.filter(filter)%20:%20results;%20%7D%20function%20querySelector(selector,%20root,%20filter)%20%7B%20const%20results%20=%20querySelectorAll(selector,%20root,%20filter);%20return%20results.length%20?%20results[0]%20:%20null;%20%7D%20const%20grid%20=%20new%20Array(6);%20for%20(let%20i%20=%200;%20i%20%3C%206;%20i%2B%2B)%20%7B%20grid[i]%20=%20new%20Array(9);%20%7D%20const%20iframeDocument%20=%20assertElement('main').querySelector('iframe').contentWindow.document;%20Array.from(assertElement(iframeDocument.querySelector('div.game-area'),%20'game%20area')%20.childNodes).forEach((node,%20index)%20=%3E%20%7B%20const%20wordIndex%20=%20index%20%%206;%20const%20letterIndex%20=%20Math.floor(index%20/%206);%20const%20letter%20=%20innerText(node).match(/[0-9]$/)%20?%20'_'%20:%20innerText(node);%20grid[wordIndex][letterIndex]%20=%20letter;%20%7D);%20const%20words%20=%20grid.map((letters)%20=%3E%20letters.join('')).join(',');%20window.open('https://feit.app/keyword/index.html?words='%20%2B%20words,%20'_blank');%20%7D)();" onclick="return doNotClick()">Keyword Solver</a>
        </td>
        <td class="versionColumn">1.0</a>
        <td>
          
Invokes the Keyword solver (with hints) on the current Keyword. Just for fun - no cheating.
        </td>
      </tr>
      <tr>
        <td class="nameColumn">
          <a href="javascript:(async%20()%20=%3E%20%7B%20/*%20*%20Turn%20On%20Design%20Mode%20*%20[v1.0]%20*%20*%20Makes%20the%20current%20web%20page%20editable!%20*/%20%22use%20strict%22;%20document.designMode%20=%20'on';%20%7D)();" onclick="return doNotClick()">Turn On Design Mode</a>
        </td>
        <td class="versionColumn">1.0</a>
        <td>
          
Makes the current web page editable!
        </td>
      </tr>
      <tr>
        <td class="nameColumn">
          <a href="javascript:(async%20()%20=%3E%20%7B%20/*%20*%20%E2%86%91%20Move%20Apps%20Script%20File%20Up%20*%20[v1.0]%20*%20*%20Moves%20the%20currently-selected%20file%20in%20the%20Apps%20Script%20editor%20up.%20*/%20class%20Logger%20%7B%20constructor(logPrefix)%20%7B%20this._logPrefix%20=%20logPrefix;%20%7D%20log(message,%20object)%20%7B%20console.log(%60[$%7Bthis._logPrefix%7D]%20$%7Bmessage%7D%60,%20object%20?%20object%20:%20'');%20%7D%20error(message,%20object)%20%7B%20console.error(%60[$%7Bthis._logPrefix%7D]%20$%7Bmessage%7D%60,%20object%20?%20object%20:%20'');%20%7D%20getLogPrefix()%20%7B%20return%20this._logPrefix;%20%7D%20_logPrefix;%20%7D%20const%20NUM_TRIES%20=%2050;%20const%20TRY_INTERVAL_MILLIS%20=%20100;%20class%20Waiter%20%7B%20constructor(logger,%20errorCreator)%20%7B%20this._logger%20=%20logger;%20this._errorCreator%20=%20errorCreator;%20%7D%20/**%20*%20Waits%20for%20an%20element%20to%20appear,%20then%20invokes%20a%20provided%20function%20on%20it.%20*%20*%20%20elementRetriever%20-%20A%20function%20that%20retrieves%20the%20target%20element.%20*%20%20elemDescription%20-%20A%20text%20description%20of%20the%20element,%20for%20logging.%20*%20%20whenFoundFunc%20-%20The%20function%20to%20invoke%20when%20the%20element%20is%20found%20(element%20is%20the%20single%20*%20parameter%20of%20it.%20*%20%20triesLeft%20-%20The%20number%20of%20retries;%20defaults%20to%2050.%20*/%20waitForSync(elementRetriever,%20elemDescription,%20whenFoundFunc,%20failureReporter,%20triesLeft)%20%7B%20const%20elem%20=%20elementRetriever();%20if%20(!elem)%20%7B%20if%20(triesLeft%20??%20NUM_TRIES)%20%7B%20this._logger.log(%60Waiting%20for%20$%7BelemDescription%7D...%60);%20const%20nextTriesLeft%20=%20(triesLeft%20??%20NUM_TRIES)%20-%201;%20setTimeout(()%20=%3E%20this.waitForSync(elementRetriever,%20elemDescription,%20whenFoundFunc,%20failureReporter,%20nextTriesLeft),%20TRY_INTERVAL_MILLIS);%20%7D%20else%20%7B%20const%20error%20=%20this._errorCreator(%60Could%20not%20find%20$%7BelemDescription%7D%60);%20failureReporter(error);%20%7D%20return;%20%7D%20this._logger.log(%60Found%20$%7BelemDescription%7D.%60);%20whenFoundFunc(elem);%20%7D%20waitFor(elementRetriever,%20elemDescription,%20numTries)%20%7B%20return%20new%20Promise((resolve,%20reject)%20=%3E%20this.waitForSync(elementRetriever,%20elemDescription,%20resolve,%20reject,%20numTries%20??%20NUM_TRIES));%20%7D%20waitMillis(millis)%20%7B%20return%20new%20Promise((resolve,%20reject)%20=%3E%20setTimeout(()%20=%3E%20resolve(undefined),%20millis));%20%7D%20_logger;%20_errorCreator;%20%7D%20function%20clickMenuItem(menuItem,%20window)%20%7B%20const%20options%20=%20%7B%20bubbles:%20true,%20cancelable:%20true,%20view:%20window%20%7D;%20menuItem.dispatchEvent(new%20MouseEvent(%22mousedown%22,%20options));%20menuItem.dispatchEvent(new%20MouseEvent(%22mouseup%22,%20options));%20return%20menuItem;%20%7D%20async%20function%20asyncMain()%20%7B%20const%20logger%20=%20new%20Logger('Move%20Apps%20Script%20File%20Up%20');%20const%20waiter%20=%20new%20Waiter(logger,%20(message)%20=%3E%20%7B%20throw%20new%20Error(message);%20%7D);%20const%20list%20=%20document.querySelector('ul[aria-label=%22Project%20files%22]');%20if%20(!list)%20%7B%20return%20alert('Could%20not%20find%20project%20files%20list');%20%7D%20let%20selectedItem%20=%20list.querySelector('li[aria-selected=%22true%22]');%20if%20(!selectedItem)%20%7B%20const%20fileName%20=%20list.getAttribute('masf_selected_file');%20if%20(fileName)%20%7B%20selectedItem%20=%20list.querySelector(%60li[aria-label=%22$%7BfileName%7D%22]%60);%20%7D%20%7D%20if%20(!selectedItem)%20%7B%20return%20alert('Could%20not%20find%20selected%20item%20in%20project%20files%20list');%20%7D%20/*%20Once%20we%20move%20it%20up,%20it's%20no%20longer%20selected.%20*/%20const%20fileName%20=%20selectedItem.getAttribute('aria-label');%20if%20(!fileName)%20%7B%20return%20alert('Could%20not%20find%20file%20name');%20%7D%20list.setAttribute('masf_selected_file',%20fileName);%20const%20button%20=%20selectedItem.querySelector('div[role=%22button%22][aria-label%5E=%22File%20operations%20menu%22]');%20if%20(!button)%20%7B%20return%20alert('Could%20not%20find%20file%20operations%20menu%20button');%20%7D%20button.click();%20const%20menuItem%20=%20await%20waiter.waitFor(()%20=%3E%20document.querySelector('span[role=%22menuitem%22][aria-label=%22Move%20file%20up%22]'),%20'move-file-up%20item');%20if%20(!menuItem)%20%7B%20return%20alert('Could%20not%20find%20move-file-up%20menu%20item');%20%7D%20/*%20For%20some%20reason%20we%20have%20to%20wait%20half%20a%20second%20before%20clicking%20the%20menu%20item.%20*/%20await%20waiter.waitMillis(500);%20clickMenuItem(menuItem,%20window);%20%7D%20asyncMain();%20%7D)();" onclick="return doNotClick()">â†‘ Move Apps Script File Up</a>
        </td>
        <td class="versionColumn">1.0</a>
        <td>
          
Moves the currently-selected file in the Apps Script editor up.
        </td>
      </tr>
      <tr>
        <td class="nameColumn">
          <a href="javascript:(async%20()%20=%3E%20%7B%20/*%20*%20Apps%20Script%20Archive%20Deployment%20*%20[v2.3]%20*%20*%20Clicks%20all%20the%20buttons%20to%20archive%20a%20deployment%20in%20Apps%20Script.%20*/%20class%20Logger%20%7B%20constructor(logPrefix)%20%7B%20this._logPrefix%20=%20logPrefix;%20%7D%20log(message,%20object)%20%7B%20console.log(%60[$%7Bthis._logPrefix%7D]%20$%7Bmessage%7D%60,%20object%20?%20object%20:%20'');%20%7D%20error(message,%20object)%20%7B%20console.error(%60[$%7Bthis._logPrefix%7D]%20$%7Bmessage%7D%60,%20object%20?%20object%20:%20'');%20%7D%20getLogPrefix()%20%7B%20return%20this._logPrefix;%20%7D%20_logPrefix;%20%7D%20function%20clickMenuItem(menuItem,%20window)%20%7B%20const%20options%20=%20%7B%20bubbles:%20true,%20cancelable:%20true,%20view:%20window%20%7D;%20menuItem.dispatchEvent(new%20MouseEvent(%22mousedown%22,%20options));%20menuItem.dispatchEvent(new%20MouseEvent(%22mouseup%22,%20options));%20return%20menuItem;%20%7D%20const%20NUM_TRIES%20=%2050;%20const%20TRY_INTERVAL_MILLIS%20=%20100;%20class%20Waiter%20%7B%20constructor(logger,%20errorCreator)%20%7B%20this._logger%20=%20logger;%20this._errorCreator%20=%20errorCreator;%20%7D%20/**%20*%20Waits%20for%20an%20element%20to%20appear,%20then%20invokes%20a%20provided%20function%20on%20it.%20*%20*%20%20elementRetriever%20-%20A%20function%20that%20retrieves%20the%20target%20element.%20*%20%20elemDescription%20-%20A%20text%20description%20of%20the%20element,%20for%20logging.%20*%20%20whenFoundFunc%20-%20The%20function%20to%20invoke%20when%20the%20element%20is%20found%20(element%20is%20the%20single%20*%20parameter%20of%20it.%20*%20%20triesLeft%20-%20The%20number%20of%20retries;%20defaults%20to%2050.%20*/%20waitForSync(elementRetriever,%20elemDescription,%20whenFoundFunc,%20failureReporter,%20triesLeft)%20%7B%20const%20elem%20=%20elementRetriever();%20if%20(!elem)%20%7B%20if%20(triesLeft%20??%20NUM_TRIES)%20%7B%20this._logger.log(%60Waiting%20for%20$%7BelemDescription%7D...%60);%20const%20nextTriesLeft%20=%20(triesLeft%20??%20NUM_TRIES)%20-%201;%20setTimeout(()%20=%3E%20this.waitForSync(elementRetriever,%20elemDescription,%20whenFoundFunc,%20failureReporter,%20nextTriesLeft),%20TRY_INTERVAL_MILLIS);%20%7D%20else%20%7B%20const%20error%20=%20this._errorCreator(%60Could%20not%20find%20$%7BelemDescription%7D%60);%20failureReporter(error);%20%7D%20return;%20%7D%20this._logger.log(%60Found%20$%7BelemDescription%7D.%60);%20whenFoundFunc(elem);%20%7D%20waitFor(elementRetriever,%20elemDescription,%20numTries)%20%7B%20return%20new%20Promise((resolve,%20reject)%20=%3E%20this.waitForSync(elementRetriever,%20elemDescription,%20resolve,%20reject,%20numTries%20??%20NUM_TRIES));%20%7D%20waitMillis(millis)%20%7B%20return%20new%20Promise((resolve,%20reject)%20=%3E%20setTimeout(()%20=%3E%20resolve(undefined),%20millis));%20%7D%20_logger;%20_errorCreator;%20%7D%20function%20innerText(node)%20%7B%20return%20node.innerText;%20%7D%20function%20elem(nodeOrId)%20%7B%20return%20(typeof%20nodeOrId%20===%20'string'%20?%20document.getElementById(nodeOrId)%20:%20nodeOrId);%20%7D%20function%20assertElement(nodeOrQuerySelector,%20description)%20%7B%20const%20isQuerySelector%20=%20typeof%20nodeOrQuerySelector%20===%20'string';%20const%20element%20=%20isQuerySelector%20?%20document.querySelector(nodeOrQuerySelector)%20:%20nodeOrQuerySelector;%20if%20(!element)%20%7B%20const%20descrip%20=%20description%20??%20'element'%20%2B%20(isQuerySelector%20?%20%60%20matching%20%22$%7BnodeOrQuerySelector%7D%22%60%20:%20'');%20throw%20new%20Error('Could%20not%20find%20'%20%2B%20descrip);%20%7D%20return%20element;%20%7D%20function%20querySelectorAll(selector,%20root,%20filter)%20%7B%20const%20results%20=%20[...(root%20??%20document).querySelectorAll(selector)]%20.map(elem%20=%3E%20elem);%20return%20filter%20?%20results.filter(filter)%20:%20results;%20%7D%20function%20querySelector(selector,%20root,%20filter)%20%7B%20const%20results%20=%20querySelectorAll(selector,%20root,%20filter);%20return%20results.length%20?%20results[0]%20:%20null;%20%7D%20const%20DAY_MILLIS%20=%2024%20*%2060%20*%2060%20*%201000;%20const%20logger%20=%20new%20Logger('Apps%20Script%20Archive%20Deployment');%20const%20waiter%20=%20new%20Waiter(logger,%20(message)%20=%3E%20%7B%20throw%20new%20Error(message);%20%7D);%20function%20findElementWithText(querySelector,%20text)%20%7B%20return%20assertElement([...document.querySelectorAll(querySelector)]%20/*%20The%20replace%20removes%20any%20non-printable%20character%20from%20the%20end.%20*/%20.find((elem)%20=%3E%20innerText(elem)%20.trim()%20.replace(/[%5E%20-~]*$/,%20'')%20.startsWith(text)%20&&%20!elem.disabled));%20%7D%20const%20findButtonWithText%20=%20(text)%20=%3E%20%7B%20return%20(findElementWithText('div[role=%22button%22]',%20text)%20??%20findElementWithText('button',%20text));%20%7D;%20const%20archiveOldest%20=%20async%20()%20=%3E%20%7B%20const%20button%20=%20await%20waiter.waitFor(()%20=%3E%20findButtonWithText('Deploy'),%20'Deploy%20button');%20button.click();%20const%20menuItem%20=%20await%20waiter.waitFor(()%20=%3E%20document.querySelector('span[role=%22menuitem%22][aria-label=%22Manage%20deployments%20option%22]'),%20'Manage%20deployments%20menu%20item');%20/*%20For%20some%20reason%20we%20have%20to%20wait%20half%20a%20second%20before%20clicking%20the%20menu%20item.%20*/%20await%20waiter.waitMillis(500);%20clickMenuItem(menuItem,%20window);%20const%20list%20=%20await%20waiter.waitFor(()%20=%3E%20document.querySelector('ul[aria-label=%22Active%20deployment%20list%22]'),%20'Active%20deployments%20list');%20const%20activeDeployments%20=%20[...list.querySelectorAll('li')];%20if%20(!activeDeployments.length)%20%7B%20return%20alert('Could%20not%20find%20any%20active%20deployments%20in%20the%20list.');%20%7D%20if%20(activeDeployments.length%20%3C%202)%20%7B%20return%20alert('Only%20one%20active%20deployment%20found.');%20%7D%20const%20lastDeployment%20=%20activeDeployments[activeDeployments.length%20-%201];%20const%20deploymentName%20=%20lastDeployment.innerText;%20lastDeployment.click();%20/*%20The%20%60*=%60%20is%20because%20there%20may%20be%20a%20space%20in%20the%20front%20of%20the%20deployment%20name.%20*/%20return%20waiter.waitForSync(()%20=%3E%20document.querySelector(%60input[value*=%22$%7BdeploymentName%7D%22]%60),%20'Deployment%20info',%20async%20(deploymentNameBox)%20=%3E%20%7B%20const%20dialog%20=%20assertElement(deploymentNameBox.closest('div[role=%22dialog%22]'),%20'dialog');%20/*%20Make%20sure%20the%20version%20to%20be%20archived%20is%20at%20least%20a%20day%20old.%20*/%20const%20match%20=%20[...dialog.querySelectorAll('span')]%20.map((span)%20=%3E%20span.innerText.trim().match(/Version%20([0-9]%2B)%20on%20(.*)/))%20.find((match)%20=%3E%20match);%20if%20(!match)%20%7B%20return%20alert('Could%20not%20find%20%22Version%20###%20on%20...%22');%20%7D%20const%20versionDate%20=%20new%20Date(match[2]);%20if%20(new%20Date().getTime()%20-%20versionDate.getTime()%20%3C%20DAY_MILLIS)%20%7B%20const%20response%20=%20confirm(%60Version%20$%7Bmatch[1]%7D%20from%20%60%20%2B%20%60$%7BversionDate.toLocaleDateString()%7D%20(%22$%7BdeploymentName%7D%22)%20%60%20%2B%20'looks%20too%20new;%20continue?');%20if%20(!response)%20%7B%20return;%20%7D%20%7D%20const%20archiveDeploymentButton%20=%20document.querySelector('button[aria-label=%22Archive%20deployment%22]');%20archiveDeploymentButton.click();%20const%20archiveButton%20=%20await%20waiter.waitFor(()%20=%3E%20findButtonWithText('Archive'),%20'Archive%20button');%20archiveButton.click();%20const%20doneButton%20=%20await%20waiter.waitFor(()%20=%3E%20%7B%20return%20findElementWithText('div',%20'Deployment%20successfully%20archived')%20?%20findButtonWithText('Done')%20:%20null;%20%7D,%20'Done%20button');%20doneButton.click();%20const%20message%20=%20%60Archived%20deployment%20#$%7BactiveDeployments.length%7D%20(%22$%7BdeploymentName%7D%22).%60;%20if%20(activeDeployments.length%20%3E%202)%20%7B%20await%20waiter.waitMillis(0);%20const%20response%20=%20confirm(message%20%2B%20'%20Archive%20the%20next%20one?');%20if%20(response)%20%7B%20await%20archiveOldest();%20%7D%20%7D%20else%20%7B%20alert(message);%20%7D%20%7D,%20(message)%20=%3E%20%7B%20throw%20new%20Error(message);%20%7D);%20%7D;%20await%20archiveOldest();%20%7D)();" onclick="return doNotClick()">Apps Script Archive Deployment</a>
        </td>
        <td class="versionColumn">2.3</a>
        <td>
          
Clicks all the buttons to archive a deployment in Apps Script.
        </td>
      </tr>
      <tr>
        <td class="nameColumn">
          <a href="javascript:(async%20()%20=%3E%20%7B%20/*%20*%20%F0%9F%93%85%20Extra%20Notifications%20for%20Calendar%20Event%20*%20[v1.1]%20*%20*%20Adds%20extra%20notifications%20for%20a%20calendar%20event.%20*/%20class%20Logger%20%7B%20constructor(logPrefix)%20%7B%20this._logPrefix%20=%20logPrefix;%20%7D%20log(message,%20object)%20%7B%20console.log(%60[$%7Bthis._logPrefix%7D]%20$%7Bmessage%7D%60,%20object%20?%20object%20:%20'');%20%7D%20error(message,%20object)%20%7B%20console.error(%60[$%7Bthis._logPrefix%7D]%20$%7Bmessage%7D%60,%20object%20?%20object%20:%20'');%20%7D%20getLogPrefix()%20%7B%20return%20this._logPrefix;%20%7D%20_logPrefix;%20%7D%20function%20elem(nodeOrId)%20%7B%20return%20(typeof%20nodeOrId%20===%20'string'%20?%20document.getElementById(nodeOrId)%20:%20nodeOrId);%20%7D%20function%20assertElement(nodeOrQuerySelector,%20description)%20%7B%20const%20isQuerySelector%20=%20typeof%20nodeOrQuerySelector%20===%20'string';%20const%20element%20=%20isQuerySelector%20?%20document.querySelector(nodeOrQuerySelector)%20:%20nodeOrQuerySelector;%20if%20(!element)%20%7B%20const%20descrip%20=%20description%20??%20'element'%20%2B%20(isQuerySelector%20?%20%60%20matching%20%22$%7BnodeOrQuerySelector%7D%22%60%20:%20'');%20throw%20new%20Error('Could%20not%20find%20'%20%2B%20descrip);%20%7D%20return%20element;%20%7D%20function%20querySelectorAll(selector,%20root,%20filter)%20%7B%20const%20results%20=%20[...(root%20??%20document).querySelectorAll(selector)]%20.map(elem%20=%3E%20elem);%20return%20filter%20?%20results.filter(filter)%20:%20results;%20%7D%20function%20querySelector(selector,%20root,%20filter)%20%7B%20const%20results%20=%20querySelectorAll(selector,%20root,%20filter);%20return%20results.length%20?%20results[0]%20:%20null;%20%7D%20function%20assert(condition,%20message,%20messageSuffix)%20%7B%20if%20(!condition)%20%7B%20if%20(typeof%20message%20===%20'function')%20%7B%20throw%20new%20Error(message());%20%7D%20const%20text%20=%20message%20?%20message%20%2B%20(messageSuffix%20?%20messageSuffix%20:%20'')%20:%20'assertion%20failed';%20throw%20new%20Error(text);%20%7D%20%7D%20function%20assertHasValue(value,%20message,%20messageSuffix)%20%7B%20assert(value,%20message,%20messageSuffix);%20return%20value;%20%7D%20function%20assertEquals(value,%20expected,%20message,%20messageSuffix)%20%7B%20const%20m%20=%20message%20?%20message%20:%20()%20=%3E%20%60Expected%20$%7Bexpected%7D,%20got%20$%7Bvalue%7D%60;%20assert(value%20===%20expected,%20message,%20messageSuffix);%20%7D%20function%20assertHasProperty(object,%20propertyName,%20message,%20disallowNullOrEmptyString)%20%7B%20if%20(object[propertyName]%20===%20undefined)%20%7B%20throw%20new%20Error(message%20?%20message%20:%20%60missing%20property%20%22$%7BpropertyName%7D%22%20in%20object:%20$%7BJSON.stringify(object)%7D%60);%20%7D%20if%20(disallowNullOrEmptyString%20&&%20!object[propertyName])%20%7B%20throw%20new%20Error(message%20?%20message%20:%20%60null/empty%20property%20%22$%7BpropertyName%7D%22%20in%20object:%20$%7BJSON.stringify(object)%7D%60);%20%7D%20return%20object[propertyName];%20%7D%20function%20assertMapValue(map,%20key,%20message,%20disallowNullOrEmptyString)%20%7B%20const%20result%20=%20map.get(key);%20if%20(result%20===%20undefined)%20%7B%20throw%20new%20Error(message%20?%20message%20:%20%60missing%20key%20%22$%7Bkey%7D%22%20in%20map:%20$%7B[...map.entries()]%7D%60);%20%7D%20if%20(disallowNullOrEmptyString%20&&%20!result)%20%7B%20throw%20new%20Error(message%20?%20message%20:%20%60null/empty%20value%20for%20%22$%7Bkey%7D%22%20in%20map:%20$%7B[...map.entries()]%7D%60);%20%7D%20return%20result;%20%7D%20function%20assertCurrentUrl(urlOrPattern)%20%7B%20const%20url%20=%20window.location.href;%20if%20(typeof%20urlOrPattern%20===%20'string')%20%7B%20if%20(url%20!==%20urlOrPattern)%20%7B%20window.alert('Must%20be%20on%20'%20%2B%20urlOrPattern);%20throw%20new%20Error('Must%20be%20on%20'%20%2B%20urlOrPattern);%20%7D%20%7D%20else%20%7B%20if%20(!urlOrPattern.test(url))%20%7B%20window.alert('Url%20must%20match%20'%20%2B%20urlOrPattern);%20throw%20new%20Error('Url%20must%20match%20'%20%2B%20urlOrPattern);%20%7D%20%7D%20%7D%20function%20assertCurrentUrlStartsWith(urlPrefix)%20%7B%20assertCurrentUrl(new%20RegExp('%5E'%20%2B%20urlPrefix));%20%7D%20function%20main()%20%7B%20const%20logger%20=%20new%20Logger('Extra%20Meeting%20Notifications%20for%20Calendar%20Event');%20assertCurrentUrl(/calendar.google.com.*/eventedit//);%20const%20NOTIFICATIONS%20=%20[%20%7B%20method:%20'Email',%20num:%2016,%20unit:%20'hours'%20%7D,%20%7B%20method:%20'Email',%20num:%204,%20unit:%20'hours'%20%7D,%20%7B%20method:%20'Notification',%20num:%202,%20unit:%20'hours'%20%7D,%20%7B%20method:%20'Notification',%20num:%2030,%20unit:%20'minutes'%20%7D,%20%7B%20method:%20'Notification',%20num:%205,%20unit:%20'minutes'%20%7D,%20];%20const%20handleRow%20=%20(remainingRows,%20notifications)%20=%3E%20%7B%20if%20(!remainingRows.length)%20%7B%20logger.log('Done.');%20return;%20%7D%20if%20(!notifications.length)%20%7B%20throw%20new%20Error('No%20notifications%20remaining;%20needed%20'%20%2B%20remainingRows.length);%20%7D%20const%20row%20=%20remainingRows.splice(0,%201)[0];%20const%20notification%20=%20notifications.splice(0,%201)[0];%20const%20method%20=%20querySelector('[role=%22combobox%22][aria-label=%22Notification%20method%22]',%20row);%20if%20(!method)%20%7B%20logger.error('No%20notification%20method%20found%20for%20row',%20row);%20return%20alert('No%20notification%20method%20found');%20%7D%20method.click();%20setTimeout(()%20=%3E%20%7B%20const%20typeOption%20=%20querySelector('li[role=%22option%22]',%20row,%20(elem)%20=%3E%20elem.innerText%20===%20notification.method);%20if%20(!typeOption)%20%7B%20logger.error(%60No%20$%7Bnotification.method%7D%20option%20found%20for%20row%60,%20row);%20return%20alert(%60No%20$%7Bnotification.method%7D%20option%20found%60);%20%7D%20typeOption.click();%20setTimeout(()%20=%3E%20%7B%20const%20num%20=%20row.querySelector('input[type=%22number%22]');%20if%20(!num)%20%7B%20logger.error('No%20number%20input%20found%20for%20row',%20row);%20return%20alert('No%20number%20input%20found');%20%7D%20num.value%20=%20notification.num.toString();%20setTimeout(()%20=%3E%20%7B%20const%20unit%20=%20querySelector('[role=%22combobox%22][aria-label=%22Unit%20of%20time%20selection%22]',%20row);%20if%20(!unit)%20%7B%20logger.error('No%20unit%20found%20for%20row',%20row);%20return%20alert('No%20unit%20found');%20%7D%20unit.click();%20setTimeout(()%20=%3E%20%7B%20const%20hourOption%20=%20querySelector('li[role=%22option%22]',%20row,%20(elem)%20=%3E%20elem.innerText%20===%20notification.unit);%20if%20(!hourOption)%20%7B%20logger.error(%60No%20%22$%7Bnotification.unit%7D%22%20option%20found%20for%20row%60,%20row);%20return%20alert(%60No%20$%7Bnotification.method%7D%20option%20found%20for%20row%60);%20%7D%20hourOption.click();%20setTimeout(()%20=%3E%20%7B%20handleRow(remainingRows,%20notifications);%20%7D,%200);%20%7D,%200);%20%7D,%200);%20%7D);%20%7D,%200);%20%7D;%20const%20setNotifications%20=%20()%20=%3E%20%7B%20const%20notificationsList%20=%20querySelector('[aria-label=%22Notifications%22]');%20if%20(!notificationsList)%20%7B%20return%20alert('No%20notifications%20list%20found');%20%7D%20const%20rows%20=%20querySelectorAll('li[data-time-value]',%20notificationsList);%20handleRow(rows,%20NOTIFICATIONS);%20%7D;%20const%20addNotifications%20=%20()%20=%3E%20%7B%20const%20button%20=%20querySelector('[aria-label=%22Add%20notification%22]');%20if%20(!button)%20%7B%20setNotifications();%20return;%20%7D%20button.click();%20setTimeout(addNotifications,%200);%20%7D;%20addNotifications();%20%7D%20main();%20%7D)();" onclick="return doNotClick()">ðŸ“… Extra Notifications for Calendar Event</a>
        </td>
        <td class="versionColumn">1.1</a>
        <td>
          
Adds extra notifications for a calendar event.
        </td>
      </tr>
      <tr>
        <td class="nameColumn">
          <a href="javascript:(async%20()%20=%3E%20%7B%20/*%20*%20Copy%20Link%20to%20Page%20*%20[v1.1]%20*%20*%20Copies%20a%20hyperlink%20to%20the%20current%20page.%20*/%20%22use%20strict%22;%20const%20a%20=%20document.createElement('a');%20a.href%20=%20window.location.href;%20document.body.insertBefore(a,%20document.body.firstChild);%20a.style.all%20=%20'initial';%20a.innerText%20=%20document.title;%20a.style.fontFamily%20=%20'Arial,%20Helvetica,%20sans-serif';%20a.style.fontSize%20=%20'10px';%20a.style.textDecoration%20=%20'underline';%20a.style.color%20=%20'rgb(0,%200,%20238)';%20const%20selection%20=%20window.getSelection();%20const%20range%20=%20document.createRange();%20range.selectNodeContents(a);%20selection.removeAllRanges();%20selection.addRange(range);%20document.execCommand('copy');%20document.body.removeChild(a);%20const%20prevBackgroundColor%20=%20document.body.style.backgroundColor;%20/*%20avoid%20copying%20the%20yellow%20background%20with%20this%200-second%20timer%20*/%20setTimeout(()%20=%3E%20%7B%20document.body.style.backgroundColor%20=%20'yellow';%20setTimeout(()%20=%3E%20(document.body.style.backgroundColor%20=%20prevBackgroundColor),%201000);%20%7D);%20%7D)();" onclick="return doNotClick()">Copy Link to Page</a>
        </td>
        <td class="versionColumn">1.1</a>
        <td>
          
Copies a hyperlink to the current page.
        </td>
      </tr>
    </table>
  </body>
</html>
